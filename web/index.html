<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°è¯´ç”Ÿæˆç³»ç»Ÿ</title>
    <link rel="stylesheet" href="style.css">
        <style>
        /* æ–°å¢çš„èµèµåŒºåŸŸæ ·å¼ */
        .donate-section {
            margin-top: 40px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 10px;
            border-top: 3px solid #6c757d;
            text-align: center;
        }

        .donate-section h3 {
            color: #495057;
            margin-bottom: 15px;
        }

        .donate-content {
            max-width: 600px;
            margin: 0 auto;
        }

        .donate-text {
            margin-bottom: 15px;
            font-size: 0.95rem;
            color: #6c757d;
        }

        .qr-codes {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
        }

        .qr-item {
            text-align: center;
        }

        .qr-item img {
            width: 300px;
            height: 300px;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 5px;
            background: white;
        }

        .qr-label {
            margin-top: 8px;
            font-weight: 500;
            color: #495057;
        }

        .donate-note {
            margin-top: 15px;
            font-size: 0.85rem;
            color: #868e96;
            font-style: italic;
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>å°è¯´ç”Ÿæˆç³»ç»Ÿ</h1>
            <nav class="tabs">
                <button class="tab-btn active" data-tab="template">ğŸ“ æ¨¡ç‰ˆç®¡ç†</button>
                <button class="tab-btn" data-tab="generate">âœ¨ å°è¯´ç”Ÿæˆ</button>
            </nav>
        </header>

        <!-- æ¨¡ç‰ˆç®¡ç† -->
        <div id="template" class="tab-content active">
            <div class="template-section">
                <div class="template-list">
                    <h3>ğŸ“‹ æ¨¡ç‰ˆåˆ—è¡¨</h3>
                    <div class="template-selector">
                        <select id="templateSelect">
                            <option value="">é€‰æ‹©æ¨¡ç‰ˆ...</option>
                        </select>
                        <button id="newTemplateBtn">â• æ–°å»ºæ¨¡ç‰ˆ</button>
                    </div>
                    <div id="templateInfo" class="template-info"></div>
                </div>

                <div class="template-editor">
                    <h3>âœï¸ æ¨¡ç‰ˆç¼–è¾‘</h3>
                    <div class="template-meta">
                        <input type="text" id="templateId" placeholder="æ¨¡ç‰ˆID (å¦‚: 001)" maxlength="3">
                        <input type="text" id="templateName" placeholder="æ¨¡ç‰ˆåç§°">
                        <input type="text" id="templateCategory" placeholder="åˆ†ç±»">
                        <div class="word-count">
                            <input type="number" id="minWords" placeholder="æœ€å°å­—æ•°" min="1000">
                            <span>-</span>
                            <input type="number" id="maxWords" placeholder="æœ€å¤§å­—æ•°" min="1000">
                        </div>
                    </div>

                    <div class="prompt-editors">
                        <div class="prompt-editor">
                            <label>ğŸ‘¤ è§’è‰²å®šä¹‰ (writer_role.txt)</label>
                            <textarea id="writerRole" placeholder="å®šä¹‰AIçš„èº«ä»½ã€ä¸“ä¸šèƒ½åŠ›ã€å†™ä½œé£æ ¼..."></textarea>
                        </div>

                        <div class="prompt-editor">
                            <label>ğŸ“œ å†™ä½œè§„åˆ™ (writing_rules.txt)</label>
                            <textarea id="writingRules" placeholder="å®šä¹‰æ‰§è¡Œè§„åˆ™ã€çº¦æŸæ¡ä»¶ã€è¾“å‡ºæ ¼å¼..."></textarea>
                        </div>

                        <div class="prompt-editor">
                            <label>ğŸ”„ çŠ¶æ€æ›´æ–°è§„åˆ™ (update_state_rules.txt)</label>
                            <textarea id="updateStateRules" placeholder="æŒ‡å¯¼AIå¦‚ä½•æ›´æ–°è§’è‰²çŠ¶æ€JSON..."></textarea>
                        </div>
                    </div>

                    <div class="template-actions">
                        <button id="saveTemplateBtn" class="btn-primary">ğŸ’¾ ä¿å­˜æ¨¡ç‰ˆ</button>
                        <button id="previewTemplateBtn" class="btn-secondary">ğŸ‘ï¸ é¢„è§ˆ</button>
                    </div>
                </div>
            </div>

            <!-- è®¾å®šç®¡ç†åŒº -->
            <div class="settings-section">
                <h2>âš™ï¸ è®¾å®šç®¡ç†</h2>

                <div class="settings-config">
                    <div class="config-group">
                        <label>ğŸ“– å°è¯´ID:</label>
                        <div class="novel-id-group">
                            <input type="text" id="settingsNovelId" placeholder="è¾“å…¥å°è¯´ID (å¦‚: 003)" maxlength="20">
                            <button id="loadSettingsBtn" class="btn-small">ğŸ“‚ åŠ è½½è®¾å®š</button>
                        </div>
                        <div id="settingsInfo" class="novel-info"></div>
                    </div>

                    <div class="settings-versions">
                        <div class="version-group">
                            <label>ğŸ‘¤ äººç‰©è®¾å®šç‰ˆæœ¬:</label>
                            <select id="characterVersionSelect">
                                <option value="">é€‰æ‹©ç‰ˆæœ¬...</option>
                            </select>
                            <button id="newCharacterBtn" class="btn-small">â• æ–°å»º</button>
                        </div>

                        <div class="version-group">
                            <label>ğŸŒ ä¸–ç•Œè®¾å®šç‰ˆæœ¬:</label>
                            <select id="worldVersionSelect">
                                <option value="">é€‰æ‹©ç‰ˆæœ¬...</option>
                            </select>
                            <button id="newWorldBtn" class="btn-small">â• æ–°å»º</button>
                        </div>
                    </div>
                </div>

                <div class="settings-editors">
                    <div class="settings-editor">
                        <label>ğŸ‘¤ äººç‰©è®¾å®š (Character State)</label>
                        <textarea id="characterSettings" placeholder="äººç‰©è®¾å®šJSONå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
                        <button id="saveCharacterBtn" class="btn-primary">ğŸ’¾ ä¿å­˜äººç‰©è®¾å®š</button>
                    </div>

                    <div class="settings-editor">
                        <label>ğŸŒ ä¸–ç•Œè®¾å®š (World Bible)</label>
                        <textarea id="worldSettings" placeholder="ä¸–ç•Œè®¾å®šJSONå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
                        <button id="saveWorldBtn" class="btn-primary">ğŸ’¾ ä¿å­˜ä¸–ç•Œè®¾å®š</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å°è¯´ç”Ÿæˆ -->
    <div id="generate" class="tab-content">
        <div class="generate-section">
            <!-- æ‰¹é‡ç”ŸæˆåŒºåŸŸ -->
            <div class="batch-generate">
                <h2>âœ¨ å°è¯´ç”Ÿæˆ</h2>
                <div class="batch-config">
                    <h3>âš™ï¸ æ‰¹é‡é…ç½®</h3>

                    <div class="config-group">
                        <label>ğŸ“– å°è¯´ID:</label>
                        <div class="novel-id-group">
                            <input type="text" id="batchNovelId" placeholder="è¾“å…¥å°è¯´ID (å¦‚: 003)" maxlength="20">
                            <button id="loadBatchNovelBtn" class="btn-small">ğŸ“‚ æ£€æµ‹è¿›åº¦</button>
                        </div>
                        <div id="batchNovelInfo" class="novel-info"></div>
                    </div>

                    <div class="config-group">
                        <label>ğŸ­ é€‰æ‹©æ¨¡ç‰ˆ:</label>
                        <select id="batchTemplateSelect">
                            <option value="">é€‰æ‹©æ¨¡ç‰ˆ...</option>
                        </select>
                    </div>

                    <div class="config-group">
                        <label>ğŸ¤– é€‰æ‹©æ¨¡å‹:</label>
                        <select id="batchModelSelect">
                            <option value="deepseek_chat">DeepSeek Chat (é»˜è®¤)</option>
                            <option value="deepseek_reasoner">DeepSeek Reasoner</option>
                            <option value="dsf5">DSF5 (ç¬¬ä¸‰æ–¹API)</option>
                            <option value="openai_gpt4">OpenAI GPT-4</option>
                            <option value="openai_gpt35">OpenAI GPT-3.5</option>
                            <option value="openrouter_gpt4o">OpenRouter GPT-4o</option>
                        </select>
                    </div>

                    <div class="config-group">
                        <label>ğŸ”„ æ›´æ–°è®¾å®šæ¨¡å‹:</label>
                        <select id="batchUpdateModelSelect">
                            <option value="">åŒç”Ÿæˆæ¨¡å‹</option>
                            <option value="deepseek_chat">DeepSeek Chat</option>
                            <option value="deepseek_reasoner">DeepSeek Reasoner</option>
                            <option value="dsf5">DSF5 (ç¬¬ä¸‰æ–¹API)</option>
                            <option value="openai_gpt4">OpenAI GPT-4</option>
                            <option value="openai_gpt35">OpenAI GPT-3.5</option>
                            <option value="openrouter_gpt4o">OpenRouter GPT-4o</option>
                        </select>
                        <small>çŠ¶æ€æ›´æ–°æ—¶ä½¿ç”¨çš„æ¨¡å‹ï¼ˆç•™ç©ºåˆ™ä½¿ç”¨ç”Ÿæˆæ¨¡å‹ï¼‰</small>
                    </div>

                    <div class="config-group">
                        <label>âš™ï¸ ç”Ÿæˆè®¾ç½®:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" id="batchUseState" checked> ä½¿ç”¨è§’è‰²çŠ¶æ€</label>
                            <label><input type="checkbox" id="batchUseWorldBible" checked> ä½¿ç”¨ä¸–ç•Œè®¾å®š</label>
                            <label><input type="checkbox" id="batchUpdateState"> æ›´æ–°è§’è‰²è®¾å®š</label>
                        </div>
                    </div>

                    <div class="config-group">
                        <label>ğŸ“– æ˜¯å¦è¯»å–å‰é¢ç« èŠ‚:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" id="batchUsePreviousChapters" checked> è¯»å–å‰é¢ç« èŠ‚å†…å®¹ã€‚</label>
                        </div>
                        <div class="chapter-help">
                            <small>
                                ğŸ’¡ <strong>è¯»å–å‰é¢ç« èŠ‚å†…å®¹</strong>ï¼šç”Ÿæˆæ—¶è¯»å–å‰é¢ç« èŠ‚çš„æœ€æ–°æ–‡ä»¶å†…å®¹ï¼Œç¡®ä¿å†…å®¹è¡”æ¥ä¸€è‡´
                            </small>
                        </div>
                    </div>

                    <div class="config-group">
                        <label>ğŸ“Š è¯»å–å‰é¢ç« èŠ‚æ•°é‡:</label>
                        <input type="number" id="batchPreviousChaptersCount" value="1" min="1" max="10">
                        <small>è®©AIè®°å¿†æ›´è¿è´¯ï¼Œï¼ˆå»ºè®®ä¸è¶…è¿‡2ç« ï¼Œæœ‰äº›ç¬¬ä¸‰æ–¹APIæ”¯æŒä¸Šä¸‹æ–‡è¾ƒå°ï¼‰ã€‚</small>
                    </div>



                    <div class="config-group">
                        <label>ğŸ“Š ç”Ÿæˆç« èŠ‚æ•°:</label>
                        <input type="number" id="batchChapterCount" value="1" min="1" max="50" placeholder="è¦ç”Ÿæˆçš„ç« èŠ‚æ•°é‡">
                        <small>ç³»ç»Ÿå°†ä»å½“å‰è¿›åº¦å¼€å§‹ï¼Œè¿ç»­ç”ŸæˆæŒ‡å®šæ•°é‡çš„ç« èŠ‚</small>
                    </div>
                </div>

                <div class="batch-progress">
                    <h3>ğŸ“ˆ ç”Ÿæˆè¿›åº¦</h3>
                    <div class="progress-bar">
                        <div id="progressFill" class="progress-fill"></div>
                    </div>
                    <div id="progressText" class="progress-text">ç­‰å¾…å¼€å§‹...</div>
                    <div id="batchLog" class="batch-log"></div>
    </div>

                <div class="batch-actions">
                    <button id="startBatchBtn" class="btn-primary">ğŸš€ å¼€å§‹è¿ç»­ç”Ÿæˆ</button>
                    <button id="stopBatchBtn" class="btn-danger" disabled>â¹ï¸ åœæ­¢ç”Ÿæˆ</button>
                    <button id="manualUpdateStateBtn" class="btn-secondary">ğŸ”„ æ‰‹åŠ¨æ›´æ–°è§’è‰²è®¾å®š</button>
                    <div id="batchStatus" class="status"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>
